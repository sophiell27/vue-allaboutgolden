import{a as m}from"./adminStore-630148c3.js";import{e as x,M,_ as y,r as u,o as c,c as p,b as l,w as g,f as e,g as _,s as V,y as k,t as h,m as O,F as f,a as b,n as P,d as $}from"./index-10c4a326.js";import{P as C}from"./PaginationComponent-bd5bd81c.js";import{_ as E}from"./lodash-82a3576f.js";import"./sweetalert2.all-b5a5b749.js";const{VITE_API:T,VITE_PATH:A}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"sophiee22",BASE_URL:"/vue-live-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},D={data(){return{orderModal:{},data:{user:{}}}},methods:{...x(m,["getOrders","toastMessage","alertMessage"]),openOrderModal(r){this.data=E.cloneDeep(r),this.orderModal.show()},closeOrderModal(){this.orderModal.hide(),this.data={user:{}}},changeOrder(){this.$swal.fire({text:"是否確定更改訂單資訊？",confirmButtonText:"確定",confirmButtonColor:"#ED8408"}).then(r=>{r.isConfirmed&&this.$http.put(`${T}api/${A}/admin/order/${this.data.id}`,{data:this.data}).then(()=>{this.closeOrderModal(),this.getOrders(),this.toastMessage("已成功更改訂單資料")}).catch(()=>{this.alertMessage("更改訂單資料發生錯誤！")})})}},mounted(){this.orderModal=new M(this.$refs.orderModal)}},I={class:"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] md:h-full",ref:"orderModal"},S={class:"relative bg-white rounded-lg shadow dark:bg-gray-700"},B={class:"flex items-start justify-between p-4 border-b rounded-t dark:border-gray-600"},U=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," 編輯訂單 ",-1),L=e("svg",{"aria-hidden":"true",class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),R=e("span",{class:"sr-only"},"Close modal",-1),q=[L,R],F={class:"grid grid-cols-1 gap-x-8 p-8"},H={class:"mb-8 md:mb-10"},z={class:"col-start-3 col-span-8"},N=e("h3",{class:"text-4.5 mb-6"}," 訂單資料",-1),j={class:"grid grid-cols-2 gap-y-4 md:gap-x-4 md:gap-y-8"},G={class:"col-span-2 md:col-span-1"},Y=e("label",{for:"recipient",class:"mb-2 block"},"收貨人：",-1),J={class:"col-span-2 md:col-span-1"},K=e("label",{for:"recipientPhone",class:"mb-2 block"},"收貨人電話：",-1),Q={class:"col-span-2"},W=e("label",{for:"receipientAddr",class:"mb-2 block"},"收貨人地址：",-1),X={class:"col-span-2 md:col-span-1"},Z=e("label",{for:"receipientMail",class:"mb-2 block"},"電郵：",-1),ee={class:"col-span-2 md:col-span-1"},te=e("label",{for:"payment",class:"mb-2 block"},"付款方法：",-1),oe=e("option",{value:"銀行轉賬",selected:""},"銀行轉賬",-1),se=e("option",{value:"貨到付款"},"貨到付款",-1),re=[oe,se],ae={class:"mb-3 flex items-center"},le=["checked"],de={for:"orderPaid",class:"block"},ne={class:"flex justify-end items-center p-6 space-x-2 border-t border-gray-200 rounded-b dark:border-gray-600"},ie=e("button",{class:"text-white bg-secondary hover:bg-primary hover:text-dark focus:ring-4 focus:outline-none focus:ring-primary font-medium rounded-lg text-sm px-5 py-2.5 text-center"},"確定",-1);function ce(r,t,v,w,s,d){const n=u("v-field"),i=u("v-error-message"),a=u("v-form");return c(),p("div",I,[l(a,{class:"relative w-full h-full max-w-2xl md:h-auto",onSubmit:d.changeOrder},{default:g(()=>[e("div",S,[e("div",B,[U,e("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white",onClick:t[0]||(t[0]=(...o)=>d.closeOrderModal&&d.closeOrderModal(...o))},q)]),e("div",F,[l(a,{class:"container",onSubmit:d.changeOrder},{default:g(()=>[e("div",H,[e("div",z,[N,e("div",j,[e("div",G,[Y,l(n,{type:"text",id:"recipient",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary placeholder:text-primary bg-transparent",placeholder:"請輸入收貨人姓名",name:"收貨人姓名",rules:"required",modelValue:s.data.user.name,"onUpdate:modelValue":t[1]||(t[1]=o=>s.data.user.name=o)},null,8,["modelValue"]),l(i,{name:"收貨人姓名",class:"text-highlight"})]),e("div",J,[K,l(n,{type:"tel",id:"recipientPhone",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary placeholder:text-primary bg-transparent",placeholder:"請輸入收貨人電話",name:"收貨人電話",rules:"required",modelValue:s.data.user.tel,"onUpdate:modelValue":t[2]||(t[2]=o=>s.data.user.tel=o)},null,8,["modelValue"]),l(i,{name:"收貨人電話",class:"text-highlight"})]),e("div",Q,[W,l(n,{type:"text",id:"receipientAddr",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary placeholder:text-primary bg-transparent",placeholder:"請輸入收貨人地址",name:"收貨人地址",rules:"required",modelValue:s.data.user.address,"onUpdate:modelValue":t[3]||(t[3]=o=>s.data.user.address=o)},null,8,["modelValue"]),l(i,{name:"收貨人地址",class:"text-highlight"})]),e("div",X,[Z,l(n,{type:"email",id:"receipientMail",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary placeholder:text-primary bg-transparent",placeholder:"請輸入電郵",name:"電郵",rules:"required",modelValue:s.data.user.email,"onUpdate:modelValue":t[4]||(t[4]=o=>s.data.user.email=o)},null,8,["modelValue"]),l(i,{name:"電郵",class:"text-highlight"})]),e("div",ee,[te,_(e("select",{id:"payment",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary placeholder:text-primary bg-transparent","onUpdate:modelValue":t[5]||(t[5]=o=>s.data.message=o)},re,512),[[V,s.data.message]])]),e("div",ae,[_(e("input",{type:"checkbox",id:"orderPaid",class:"rounded-sm mr-2 ring-2 ring-primary indeterminate:bg-white indeterminate:ring-offset-primary ring-offset-primary checked:bg-primary focus:outline-none focus:ring focus:ring-primary valid:border-primary","onUpdate:modelValue":t[6]||(t[6]=o=>s.data.is_paid=o),checked:s.data.is_paid},null,8,le),[[k,s.data.is_paid]]),e("label",de,h(s.data.is_paid?"已付款":"未付款"),1)])])])])]),_:1},8,["onSubmit"])]),e("div",ne,[e("button",{"data-modal-hide":"defaultModal",type:"button",class:"text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-0 focus:ring-blue-300 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10",onClick:t[7]||(t[7]=(...o)=>d.closeOrderModal&&d.closeOrderModal(...o))},"取消"),ie])])]),_:1},8,["onSubmit"])],512)}const pe=y(D,[["render",ce]]),{VITE_API:he,VITE_PATH:ue}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"sophiee22",BASE_URL:"/vue-live-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},me={data(){return{}},computed:{...O(m,["orders","orderPagination"])},components:{PaginationComponent:C,OrderComponent:pe},methods:{...x(m,["getOrders","toastMessage","alertMessage"]),getFormatDate(r){const t=new Date(r*1e3);return`${t.getDate()}/${t.getMonth()}/${t.getFullYear()}`},openOrderModal(r){this.$refs.orderModal.openOrderModal(r)},delOrder(r){this.alertMessage("是否確定刪除訂單?").then(t=>{t.isConfirmed&&this.$http.delete(`${he}api/${ue}/admin/order/${r}`).then(()=>{this.getOrders(),this.toastMessage("成功刪除一筆訂單")}).catch(()=>{this.alertMessage("無法刪除一筆訂單")})})}},mounted(){this.getOrders(this.$route.params.orderpage)}},ge={class:"container pt-10 md:pt-16"},_e=e("h2",{class:"titleDash text-h4 text-center text-dark pb-5 mb-7"},"訂單列表",-1),fe={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},be={class:"w-full text-sm text-left text-fog-500"},xe=e("thead",{class:"font-extrabold text-4.5 text-fog-500 bg-fog-200 whitespace-nowrap"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"}," 日期 "),e("th",{scope:"col",class:"px-6 py-3"}," 訂單編號 "),e("th",{scope:"col",class:"px-6 py-3"}," 訂單內容 "),e("th",{scope:"col",class:"px-6 py-3"}," 總計 "),e("th",{scope:"col",class:"px-6 py-3"}," 是否付款 "),e("th",{scope:"col",class:"px-6 py-3"}," 編輯 ")])],-1),ye={class:"px-2 py-4 md:px-6"},ve={class:"px-2 py-4 md:px-6 text-xs whitespace-normal"},we={class:"px-2 py-4 text-xs md:px-6"},Me={class:"px-2 py-4 md:px-6 text-xs"},Ve={class:"px-2 py-4 md:px-6"},ke=["onClick"],Oe=["onClick"];function Pe(r,t,v,w,s,d){const n=u("OrderComponent"),i=u("PaginationComponent");return c(),p("div",ge,[l(n,{ref:"orderModal"},null,512),_e,e("div",fe,[e("table",be,[xe,e("tbody",null,[(c(!0),p(f,null,b(r.orders,a=>(c(),p("tr",{class:"bg-white border-b hover:bg-fog-100",key:a.create_at},[e("td",ye,h(d.getFormatDate(a.create_at)),1),e("td",ve,h(a.id),1),e("td",we,[(c(!0),p(f,null,b(a.products,o=>(c(),p("p",{key:`item${o.id}`},h(`${o.product.title} x ${o.qty}`),1))),128))]),e("td",Me," NT $ "+h(a.total),1),e("td",{class:P(["px-2 py-4 md:px-6 whitespace-nowrap",{"text-highlight border-b-highlight":!a.is_paid}])},h(a.is_paid?"已付款":"未付款"),3),e("td",Ve,[e("button",{type:"button",class:"pb-px border-b border-b-secondary hover:text-highlight hover:border-b-highlight",onClick:o=>d.openOrderModal(a)}," 編輯 ",8,ke),$(" / "),e("button",{type:"button",class:"pb-px border-b border-b-secondary hover:text-highlight hover:border-b-highlight",onClick:o=>d.delOrder(a.id)}," 刪除 ",8,Oe)])]))),128))])]),l(i,{pagination:r.orderPagination,onGetpage:r.getOrders},null,8,["pagination","onGetpage"])])])}const De=y(me,[["render",Pe]]);export{De as default};
