import{a as y}from"./adminStore-62420e31.js";import{a as P,M as V,_ as k,r as g,o as d,c as a,d as n,w as x,b as e,j as w,k as f,v,x as M,m as C,F as U,i as I,t as h,n as T,e as E}from"./index-2705f1b9.js";import{P as A}from"./PaginationComponent-9ea49e1b.js";const{VITE_API:b,VITE_PATH:_}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"sophiee22",BASE_URL:"/vue-live-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},$={data(){return{productModal:{},temp:{imagesUrl:[""]}}},methods:{...P(y,["getProducts"]),openProductModal(s={imagesUrl:[""]}){this.temp={...s},console.log(this.temp),this.productModal.show()},closeProductModal(){this.productModal.hide(),this.temp={imagesUrl:[""]}},delImg(){confirm("是否確定刪除圖片？")&&(this.temp.imageUrl="")},uploadFile(s){let t;s==="filtINput"?t=this.$refs[s].files[0]:t=this.$refs[s][0].files[0];const p=new FormData;p.append("file-to-upload",t),confirm("是否確定上傳檔案？")&&this.$http.post(`${b}api/${_}/admin/upload`,p).then(m=>{s==="filtINput"?this.temp.imageUrl=m.data.imageUrl:(this.temp.imagesUrl[this.temp.imagesUrl.length-1]=m.data.imageUrl,console.log(this.temp.imagesUrl))}).catch(m=>{console.log(m)})},editProduct(){let s="post",t=`${b}api/${_}/admin/product`;this.temp.id&&(s="put",t=`${b}api/${_}/admin/product/${this.temp.id}`),this.$http[s](t,{data:this.temp}).then(p=>{this.closeProductModal(),this.getProducts()}).catch(p=>{alert("無法編輯商品！"),this.closeProductModal()})}},mounted(){this.productModal=new V(this.$refs.productModal)}},D={class:"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] md:h-full",ref:"productModal"},S={class:"relative bg-white rounded-lg shadow dark:bg-gray-700"},N={class:"flex items-start justify-between p-4 border-b rounded-t dark:border-gray-600"},L={class:"text-xl font-semibold text-gray-900 dark:text-white"},B={key:0},O={key:1},R=e("svg",{"aria-hidden":"true",class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),q=e("span",{class:"sr-only"},"Close modal",-1),F=[R,q],H={class:"grid grid-cols-2 gap-x-8 p-8"},z={class:"col-span-1"},j={class:"mb-5"},G=e("label",{class:"mb-3 block",for:"mainImg"},"主要圖片",-1),J={key:0,class:""},K=["src"],Q={class:"col-span1"},W={class:"grid grid-cols-2 gap-x-2"},X={class:"mb-3 col-span-2"},Y=e("label",{for:"productTitle",class:"mb-2 block"},"標題",-1),Z={class:"mb-3 col-span-1"},ee=e("label",{for:"productCat",class:"mb-2 block"},"分類",-1),te=e("option",{value:"配件配飾",class:"py-1"},"配件配飾",-1),oe=e("option",{value:"居家配件"},"居家配件",-1),re=e("option",{value:"床上用品"},"床上用品",-1),se=e("option",{value:"科技配件"},"科技配件",-1),le=e("option",{value:"衣物大全"},"衣物大全",-1),ie=e("option",{value:"有狗亂入"},"有狗亂入",-1),ne={class:"mb-3 col-span-1"},de=e("label",{for:"productUnit",class:"mb-2 block"},"單位",-1),ae={class:"mb-3 col-span-1"},ce=e("label",{for:"productOriginPrice",class:"mb-2 block"},"原價",-1),ue={class:"mb-3 col-span-1"},pe=e("label",{for:"productPrice",class:"mb-2 block"},"售價",-1),me={class:"mb-3 col-span-2"},he=e("label",{for:"productDesc",class:"mb-2 block"},"產品描述",-1),ge={class:"mb-3 col-span-2"},fe=e("label",{for:"productContent",class:"mb-2 block"},"說明內容",-1),be={class:"mb-3 flex items-center"},_e=e("label",{for:"productEnable",class:"block"},"是否啟用",-1),ye={class:"flex justify-end items-center p-6 space-x-2 border-t border-gray-200 rounded-b dark:border-gray-600"},xe=e("button",{class:"text-white bg-secondary hover:bg-primary hover:text-dark focus:ring-4 focus:outline-none focus:ring-primary font-medium rounded-lg text-sm px-5 py-2.5 text-center"},"確定",-1);function ve(s,t,p,m,r,l){const c=g("v-field"),u=g("v-error-message"),i=g("v-form");return d(),a("div",D,[n(i,{class:"relative w-full h-full max-w-2xl md:h-auto",onSubmit:l.editProduct},{default:x(()=>[e("div",S,[e("div",N,[e("h3",L,[r.temp.id?(d(),a("span",B,"編輯商品")):(d(),a("span",O,"新增商品"))]),e("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white",onClick:t[0]||(t[0]=(...o)=>l.closeProductModal&&l.closeProductModal(...o))},F)]),e("div",H,[e("div",z,[e("div",j,[G,r.temp.imageUrl?(d(),a("div",J,[e("img",{src:r.temp.imageUrl,alt:"",class:"img-fluid mb-3"},null,8,K)])):w("",!0),r.temp.imageUrl?(d(),a("button",{key:1,type:"button",class:"mb-4 w-full text-white bg-secondary hover:bg-primary hover:text-dark focus:ring-4 focus:outline-none focus:ring-primary font-medium rounded-lg text-sm px-5 py-2.5 text-center",onClick:t[1]||(t[1]=(...o)=>l.delImg&&l.delImg(...o))},"刪除圖片")):(d(),a("input",{key:2,type:"file",class:"block text-sm border border-none rounded-lg cursor-pointer bg-secondary text-white focus:outline-none hover:bg-primary hover:text-dark",id:"mainImg",onChange:t[2]||(t[2]=o=>l.uploadFile("filtINput")),ref:"filtINput"},null,544))])]),e("div",Q,[e("div",W,[e("div",X,[Y,n(c,{type:"text",id:"productTitle",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",placeholder:"請輸入標題",modelValue:r.temp.title,"onUpdate:modelValue":t[3]||(t[3]=o=>r.temp.title=o),name:"標題",rules:"required"},null,8,["modelValue"]),n(u,{name:"標題",class:"text-highlight"})]),e("div",Z,[ee,n(c,{as:"select",id:"productCat",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",modelValue:r.temp.category,"onUpdate:modelValue":t[4]||(t[4]=o=>r.temp.category=o),name:"分類",rules:"required"},{default:x(()=>[te,oe,re,se,le,ie]),_:1},8,["modelValue"]),n(u,{name:"分類",class:"text-highlight"})]),e("div",ne,[de,n(c,{type:"text",id:"productUnit",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",placeholder:"請輸入單位",modelValue:r.temp.unit,"onUpdate:modelValue":t[5]||(t[5]=o=>r.temp.unit=o),name:"單位",rules:"required"},null,8,["modelValue"]),n(u,{name:"單位",class:"text-highlight"})]),e("div",ae,[ce,n(c,{type:"number",id:"productOriginPrice",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",placeholder:"請輸入原價",modelValue:r.temp.origin_price,"onUpdate:modelValue":t[6]||(t[6]=o=>r.temp.origin_price=o),modelModifiers:{number:!0},name:"原價",rules:"required|min_value:1",min:"1"},null,8,["modelValue"]),n(u,{name:"原價",class:"text-highlight"})]),e("div",ue,[pe,n(c,{type:"number",id:"productPrice",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",placeholder:"請輸入售價",modelValue:r.temp.price,"onUpdate:modelValue":t[7]||(t[7]=o=>r.temp.price=o),modelModifiers:{number:!0},name:"售價",rules:"required|min_value:1",min:"1"},null,8,["modelValue"]),n(u,{name:"售價",class:"text-highlight"})]),e("div",me,[he,f(e("textarea",{type:"text",id:"productDesc",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",placeholder:"請輸入產品描述","onUpdate:modelValue":t[8]||(t[8]=o=>r.temp.description=o)},null,512),[[v,r.temp.description]])]),e("div",ge,[fe,f(e("textarea",{type:"text",id:"productContent",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",placeholder:"請輸入說明內容","onUpdate:modelValue":t[9]||(t[9]=o=>r.temp.content=o)},null,512),[[v,r.temp.content]])]),e("div",be,[f(e("input",{type:"checkbox",id:"productEnable",class:"rounded-sm mr-2 ring-2 ring-primary indeterminate:bg-white indeterminate:ring-offset-primary ring-offset-primary checked:bg-primary focus:outline-none focus:ring focus:ring-primary valid:border-primary","onUpdate:modelValue":t[10]||(t[10]=o=>r.temp.is_enabled=o)},null,512),[[M,r.temp.is_enabled]]),_e])])])]),e("div",ye,[e("button",{"data-modal-hide":"defaultModal",type:"button",class:"text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-blue-300 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600",onClick:t[11]||(t[11]=(...o)=>l.closeProductModal&&l.closeProductModal(...o))},"取消"),xe])])]),_:1},8,["onSubmit"])],512)}const Pe=k($,[["render",ve]]),{VITE_API:ke,VITE_PATH:we}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"sophiee22",BASE_URL:"/vue-live-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Ve={data(){return{}},components:{PaginationComponent:A,ProductModalComponent:Pe},methods:{...P(y,["getProducts"]),openProductModal(s){this.$refs.productModal.openProductModal(s)},delProduct(s){confirm("是否確定刪除商品？")&&this.$http.delete(`${ke}api/${we}/admin/product/${s}`).then(()=>{this.getProducts()}).catch(()=>{alert("無法刪除商品")})}},computed:{...C(y,["products","productsPagination"])},mounted(){this.getProducts()}},Me={class:"container flex flex-col h-full"},Ce=e("h1",{class:"text-h4 text-center mb-8"},"產品列表",-1),Ue={key:0,class:"w-full mb-auto"},Ie=e("thead",{class:"border-b border-b-secondary"},[e("tr",null,[e("th",{class:"w-20"},"產品編號"),e("th",null,"產品名稱"),e("th",null,"類別"),e("th",null,"原價"),e("th",null,"售價"),e("th",null,"上架狀態"),e("th",null,"編輯")])],-1),Te={class:"text-center my-2 hover:bg-fog-200"},Ee={class:"text-xs py-2"},Ae={class:"py-2"},$e={class:"py-2"},De={class:"py-2 text-sm"},Se={class:"py-2 text-sm"},Ne=["onClick"],Le=["onClick"];function Be(s,t,p,m,r,l){const c=g("ProductModalComponent"),u=g("PaginationComponent");return d(),a("div",Me,[n(c,{ref:"productModal"},null,512),Ce,e("button",{class:"self-start mb-8 text-white bg-secondary hover:bg-primary focus:ring-4 focus:outline-none focus:ring-primary font-medium rounded-lg text-sm px-5 py-2.5 text-center",type:"button",onClick:t[0]||(t[0]=(...i)=>l.openProductModal&&l.openProductModal(...i))}," 新增商品 "),s.products?(d(),a("table",Ue,[Ie,e("tbody",null,[(d(!0),a(U,null,I(s.products,i=>(d(),a("tr",Te,[e("td",Ee,h(i.id),1),e("td",Ae,h(i.title),1),e("td",$e,h(i.category),1),e("td",De," NT$"+h(i.origin_price),1),e("td",Se,"NT$"+h(i.price),1),e("td",{class:T(["py-2",{"text-highlight border-b-highlight":i.is_enabled}])},h(i.is_enabled?"已上架":"未上架")+" ",3),e("td",null,[e("button",{type:"button",class:"pb-px border-b border-b-secondary hover:text-highlight hover:border-b-highlight",onClick:o=>l.openProductModal(i)}," 編輯 ",8,Ne),E(" / "),e("button",{type:"button",class:"pb-px border-b border-b-secondary hover:text-highlight hover:border-b-highlight",onClick:o=>l.delProduct(i.id)}," 刪除 ",8,Le)])]))),256))])])):w("",!0),n(u,{pagination:s.productsPagination,onGetpage:s.getProducts},null,8,["pagination","onGetpage"])])}const Fe=k(Ve,[["render",Be]]);export{Fe as default};
