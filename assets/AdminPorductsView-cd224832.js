import{a as y}from"./adminStore-9d31572d.js";import{e as P,M as k,_ as w,r as m,o as d,c as a,b as n,w as x,f as e,i as M,g as f,v,y as V,m as C,F as I,a as U,t as p,n as T,d as E}from"./index-63941f38.js";import{P as $}from"./PaginationComponent-773d4075.js";import{_ as A}from"./lodash-50936451.js";import"./sweetalert2.all-2a6e8b79.js";const{VITE_API:b,VITE_PATH:_}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"sophiee22",BASE_URL:"/vue-live-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},D={data(){return{productModal:{},temp:{imagesUrl:[""]}}},methods:{...P(y,["getProducts","alertMessage"]),openProductModal(r={imagesUrl:[""]}){this.temp=A.cloneDeep(r),this.productModal.show()},closeProductModal(){this.productModal.hide(),this.temp={imagesUrl:[""]}},delImg(){window.confirm("是否確定刪除圖片？")&&(this.temp.imageUrl="")},uploadFile(r){const[t]=r==="filtINput"?this.$refs[r].files:this.$refs[r][0].files,h=new FormData;h.append("file-to-upload",t),this.$swal.fire({text:"是否確定上傳檔案？",confirmButtonText:"確定"}).then(g=>{g.isConfirmed&&this.$http.post(`${b}api/${_}/admin/upload`,h).then(o=>{r==="filtINput"?this.temp.imageUrl=o.data.imageUrl:this.temp.imagesUrl[this.temp.imagesUrl.length-1]=o.data.imageUrl}).catch(()=>{this.alertMessage("更新圖片發生錯誤！")})})},editProduct(){let r="post",t=`${b}api/${_}/admin/product`;this.temp.id&&(r="put",t=`${b}api/${_}/admin/product/${this.temp.id}`),this.$http[r](t,{data:this.temp}).then(()=>{this.getProducts(),this.closeProductModal()}).catch(()=>{this.closeProductModal()})}},mounted(){this.productModal=new k(this.$refs.productModal)}},S={class:"fixed top-0 left-0 right-0 z-50 hidden w-full p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] md:h-full",ref:"productModal"},N={class:"relative bg-white rounded-lg shadow dark:bg-gray-700"},B={class:"flex items-start justify-between p-4 border-b rounded-t dark:border-gray-600"},L={class:"text-xl font-semibold text-gray-900 dark:text-white"},O={key:0},R={key:1},q=e("svg",{"aria-hidden":"true",class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1),F=e("span",{class:"sr-only"},"Close modal",-1),H=[q,F],z={class:"grid grid-cols-2 gap-x-8 p-8"},j={class:"col-span-2 sm:col-span-1"},G={class:"mb-5"},J=e("label",{class:"mb-3 block",for:"mainImg"},"主要圖片",-1),K={key:0,class:""},Q=["src"],W={class:"col-span-2 sm:col-span-1"},X={class:"grid grid-cols-2 gap-x-2"},Y={class:"mb-3 col-span-2"},Z=e("label",{for:"productTitle",class:"mb-2 block"},"標題",-1),ee={class:"mb-3 col-span-1"},te=e("label",{for:"productCat",class:"mb-2 block"},"分類",-1),oe=e("option",{value:"配件配飾",class:"py-1"},"配件配飾",-1),se=e("option",{value:"居家配件"},"居家配件",-1),re=e("option",{value:"床上用品"},"床上用品",-1),le=e("option",{value:"科技配件"},"科技配件",-1),ie=e("option",{value:"衣物大全"},"衣物大全",-1),ne=e("option",{value:"有狗亂入"},"有狗亂入",-1),de={class:"mb-3 col-span-1"},ae=e("label",{for:"productUnit",class:"mb-2 block"},"單位",-1),ce={class:"mb-3 col-span-1"},ue=e("label",{for:"productOriginPrice",class:"mb-2 block"},"原價",-1),pe={class:"mb-3 col-span-1"},me=e("label",{for:"productPrice",class:"mb-2 block"},"售價",-1),he={class:"mb-3 col-span-2"},ge=e("label",{for:"productDesc",class:"mb-2 block"},"產品描述",-1),fe={class:"mb-3 col-span-2"},be=e("label",{for:"productContent",class:"mb-2 block"},"說明內容",-1),_e={class:"mb-3 flex items-center"},ye=e("label",{for:"productEnable",class:"block"},"是否啟用",-1),xe={class:"flex justify-end items-center p-6 space-x-2 border-t border-gray-200 rounded-b dark:border-gray-600"},ve=e("button",{class:"text-white bg-secondary hover:bg-primary hover:text-dark focus:ring-4 focus:outline-none focus:ring-primary font-medium rounded-lg text-sm px-5 py-2.5 text-center"},"確定",-1);function Pe(r,t,h,g,o,i){const c=m("v-field"),u=m("v-error-message"),l=m("v-form");return d(),a("div",S,[n(l,{class:"relative w-full h-full max-w-2xl md:h-auto",onSubmit:i.editProduct},{default:x(()=>[e("div",N,[e("div",B,[e("h3",L,[o.temp.id?(d(),a("span",O,"編輯商品")):(d(),a("span",R,"新增商品"))]),e("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white",onClick:t[0]||(t[0]=(...s)=>i.closeProductModal&&i.closeProductModal(...s))},H)]),e("div",z,[e("div",j,[e("div",G,[J,o.temp.imageUrl?(d(),a("div",K,[e("img",{src:o.temp.imageUrl,alt:"",class:"img-fluid mb-3"},null,8,Q)])):M("",!0),o.temp.imageUrl?(d(),a("button",{key:1,type:"button",class:"mb-4 text-white bg-secondary hover:bg-primary hover:text-dark focus:ring-4 focus:outline-none focus:ring-primary font-medium rounded-lg text-sm px-5 py-2.5 text-center",onClick:t[1]||(t[1]=(...s)=>i.delImg&&i.delImg(...s))},"刪除圖片")):(d(),a("input",{key:2,type:"file",class:"text-sm border border-none rounded-lg cursor-pointer bg-secondary text-white focus:outline-none hover:bg-primary hover:text-dark",id:"mainImg",onChange:t[2]||(t[2]=s=>i.uploadFile("filtINput")),ref:"filtINput"},null,544))])]),e("div",W,[e("div",X,[e("div",Y,[Z,n(c,{type:"text",id:"productTitle",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",placeholder:"請輸入標題",modelValue:o.temp.title,"onUpdate:modelValue":t[3]||(t[3]=s=>o.temp.title=s),name:"標題",rules:"required"},null,8,["modelValue"]),n(u,{name:"標題",class:"text-highlight"})]),e("div",ee,[te,n(c,{as:"select",id:"productCat",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",modelValue:o.temp.category,"onUpdate:modelValue":t[4]||(t[4]=s=>o.temp.category=s),name:"分類",rules:"required"},{default:x(()=>[oe,se,re,le,ie,ne]),_:1},8,["modelValue"]),n(u,{name:"分類",class:"text-highlight"})]),e("div",de,[ae,n(c,{type:"text",id:"productUnit",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",placeholder:"請輸入單位",modelValue:o.temp.unit,"onUpdate:modelValue":t[5]||(t[5]=s=>o.temp.unit=s),name:"單位",rules:"required"},null,8,["modelValue"]),n(u,{name:"單位",class:"text-highlight"})]),e("div",ce,[ue,n(c,{type:"number",id:"productOriginPrice",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",placeholder:"請輸入原價",modelValue:o.temp.origin_price,"onUpdate:modelValue":t[6]||(t[6]=s=>o.temp.origin_price=s),modelModifiers:{number:!0},name:"原價",rules:"required|min_value:1",min:"1"},null,8,["modelValue"]),n(u,{name:"原價",class:"text-highlight"})]),e("div",pe,[me,n(c,{type:"number",id:"productPrice",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",placeholder:"請輸入售價",modelValue:o.temp.price,"onUpdate:modelValue":t[7]||(t[7]=s=>o.temp.price=s),modelModifiers:{number:!0},name:"售價",rules:"required|min_value:1",min:"1"},null,8,["modelValue"]),n(u,{name:"售價",class:"text-highlight"})]),e("div",he,[ge,f(e("textarea",{type:"text",id:"productDesc",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",placeholder:"請輸入產品描述","onUpdate:modelValue":t[8]||(t[8]=s=>o.temp.description=s)},null,512),[[v,o.temp.description]])]),e("div",fe,[be,f(e("textarea",{type:"text",id:"productContent",class:"w-full rounded-lg px-4 py-2 border-primary focus:outline-none focus:ring focus:ring-primary focus:border-primary",placeholder:"請輸入說明內容","onUpdate:modelValue":t[9]||(t[9]=s=>o.temp.content=s)},null,512),[[v,o.temp.content]])]),e("div",_e,[f(e("input",{type:"checkbox",id:"productEnable",class:"rounded-sm mr-2 ring-2 ring-primary indeterminate:bg-white indeterminate:ring-offset-primary ring-offset-primary checked:bg-primary focus:outline-none focus:ring focus:ring-primary valid:border-primary","onUpdate:modelValue":t[10]||(t[10]=s=>o.temp.is_enabled=s)},null,512),[[V,o.temp.is_enabled]]),ye])])])]),e("div",xe,[e("button",{"data-modal-hide":"defaultModal",type:"button",class:"text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-blue-300 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10",onClick:t[11]||(t[11]=(...s)=>i.closeProductModal&&i.closeProductModal(...s))},"取消"),ve])])]),_:1},8,["onSubmit"])],512)}const we=w(D,[["render",Pe]]),{VITE_API:Me,VITE_PATH:ke}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"sophiee22",BASE_URL:"/vue-live-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Ve={data(){return{}},components:{PaginationComponent:$,ProductModalComponent:we},methods:{...P(y,["getProducts","alertMessage"]),openProductModal(r){this.$refs.productModal.openProductModal(r)},delProduct(r){this.$swal.fire({text:"是否確定刪除商品？",confirmButtonText:"確定"}).then(t=>{t.isConfirmed&&this.$http.delete(`${Me}api/${ke}/admin/product/${r}`).then(()=>{this.getProducts(),this.toastMessge("已成功刪除一筆產品資料")}).catch(()=>{this.alertMessage("無法刪除商品")})})}},computed:{...C(y,["products","productsPagination"])},mounted(){this.getProducts(this.$route.params.productpage)}},Ce={class:"container flex flex-col h-full"},Ie=e("h1",{class:"text-h4 text-center mb-8"},"產品列表",-1),Ue={key:0,class:"w-full mb-auto"},Te=e("thead",{class:"border-b border-b-secondary"},[e("tr",null,[e("th",{class:"w-20"},"產品編號"),e("th",null,"產品名稱"),e("th",null,"類別"),e("th",null,"原價"),e("th",null,"售價"),e("th",null,"上架狀態"),e("th",null,"編輯")])],-1),Ee={class:"text-xs py-2"},$e={class:"py-2"},Ae={class:"py-2"},De={class:"py-2 text-sm"},Se={class:"py-2 text-sm"},Ne=["onClick"],Be=["onClick"];function Le(r,t,h,g,o,i){const c=m("ProductModalComponent"),u=m("PaginationComponent");return d(),a("div",Ce,[n(c,{ref:"productModal"},null,512),Ie,e("button",{class:"self-start mb-8 text-white bg-secondary hover:bg-primary focus:ring-4 focus:outline-none focus:ring-primary font-medium rounded-lg text-sm px-5 py-2.5 text-center",type:"button",onClick:t[0]||(t[0]=(...l)=>i.openProductModal&&i.openProductModal(...l))}," 新增商品 "),r.products?(d(),a("table",Ue,[Te,e("tbody",null,[(d(!0),a(I,null,U(r.products,l=>(d(),a("tr",{class:"text-center my-2 hover:bg-fog-200",key:l.id},[e("td",Ee,p(l.id),1),e("td",$e,p(l.title),1),e("td",Ae,p(l.category),1),e("td",De," NT$"+p(l.origin_price),1),e("td",Se,"NT$"+p(l.price),1),e("td",{class:T(["py-2",{"text-highlight border-b-highlight":l.is_enabled}])},p(l.is_enabled?"已上架":"未上架"),3),e("td",null,[e("button",{type:"button",class:"pb-px border-b border-b-secondary hover:text-highlight hover:border-b-highlight",onClick:s=>i.openProductModal(l)}," 編輯 ",8,Ne),E(" / "),e("button",{type:"button",class:"pb-px border-b border-b-secondary hover:text-highlight hover:border-b-highlight",onClick:s=>i.delProduct(l.id)}," 刪除 ",8,Be)])]))),128))])])):M("",!0),n(u,{pagination:r.productsPagination,onGetpage:r.getProducts},null,8,["pagination","onGetpage"])])}const ze=w(Ve,[["render",Le]]);export{ze as default};
