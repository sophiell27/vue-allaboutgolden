import{q as T,s as h,m as b,a as C,_ as P,r as E,o as l,c as n,b as e,F as I,i as v,t as u,j as g,d as y,w as V}from"./index-1e4177ee.js";import{N as A}from"./NewProductsComponent-b7e1d1c4.js";const{VITE_API:c,VITE_PATH:d}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"sophiee22",BASE_URL:"/vue-live-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},m=T("FrontStore",{state:()=>({products:[],tempProduct:{},carts:[]}),getters:{cartTotal:({carts:t})=>t.reduce((o,s)=>o+s.final_total,0),cartlength:({carts:t})=>t.length},actions:{getProducts(){h.get(`${c}api/${d}/products/all`).then(t=>{this.products=t.data.products,console.log(t.data)}).catch(t=>{alert("無法取得產品列表")})},getSingleProduct(t){h.get(`${c}api/${d}/product/${t}`).then(o=>{this.tempProduct=o.data.product}).catch(o=>{alert("取得商品資訊發生錯誤")})},getCarts(){h.get(`${c}api/${d}/cart`).then(t=>{this.carts=t.data.data.carts}).catch(()=>{alert("無法取得產品列表")})},addCart(t,o=1){console.log(t);let s="post",r=`${c}api/${d}/cart`;t.qty&&(s="put",r=`${c}api/${d}/cart/${t.id}`,o+=t.qty);const p={product_id:t.id,qty:o};h[s](r,{data:p}).then(i=>{alert("已加入購物車！"),this.getCarts()}).catch(i=>{alert("加入購物車發生錯誤")})}}}),{VITE_API:$,VITE_PATH:f}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"sophiee22",BASE_URL:"/vue-live-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},S={components:{NewProductsComponent:A},computed:{...b(m,["carts","cartTotal"])},methods:{...C(m,["getCarts"]),changeQty(t,o){console.log(o.target.value);const s={product_id:t,qty:Number(o.target.value)};console.log(s),this.$http.put(`${$}api/${f}/cart/${t}`,{data:s}).then(r=>{alert("已更改數量"),this.getCarts()}).catch(r=>{alert("無法更改數量")})},delCartItem(t){this.$http.delete(`${$}api/${f}/cart/${t}`).then(()=>{this.getCarts()}).catch(()=>{alert("無法刪除購物車內容")})}},mounted(){this.getCarts()}},k={class:"w-full text-center mb-6"},N=e("thead",null,[e("tr",{class:"font-extrabold text-4.5"},[e("th"),e("th",null,"產品"),e("th",null,"價錢"),e("th",null,"數量"),e("th",null,"小計"),e("th",null,"刪除")])],-1),w={class:"lg:w-24 lg:h-24"},R=["src","alt"],D={class:"text-xs"},B={class:"text-xs"},H=["value","onChange"],L={class:"text-xs"},q=["onClick"],O={class:"border-t border-t-fog-500 border-spacing-1"},F={class:""},U={colspan:"3",class:"text-end"},M={key:0,class:"inline-block px-2 bg-fog-200"},Q=e("td",{class:""},"總計:",-1),j={key:0,colspan:"5"},z=e("button",{type:"button",class:"py-2 px-12 bg-secondary rounded-lg2 text-white flex ml-auto mt-4 hover:bg-primary hover:text-dark"},"結帳",-1);function G(t,o,s,r,p,i){const x=E("RouterLink");return l(),n("table",k,[N,e("tbody",null,[(l(!0),n(I,null,v(t.carts,a=>(l(),n("tr",null,[e("td",w,[e("img",{src:a.product.imageUrl,alt:a.product.title},null,8,R)]),e("td",null,u(a.product.title),1),e("td",D,"NT $ "+u(a.product.price),1),e("td",B,[e("input",{type:"number",min:"1",value:a.qty,class:"w-8 pl-1 text-center border-none bg-fog-100 rounded-md md:mx-1 md:py-1 md:w-20 md:pl-2 md:bg-fog-200",onChange:_=>i.changeQty(a.id,_)},null,40,H)]),e("td",L,"NT $ "+u(a.final_total),1),e("td",null,[e("button",{type:"button",class:"hover:text-highlight",onClick:_=>i.delCartItem(a.id)}," x ",8,q)])]))),256))]),e("tfoot",O,[e("tr",F,[e("td",U,[t.cartTotal>=900?(l(),n("p",M,"已達免運費門檻")):g("",!0)]),Q,e("td",null,"NT$ "+u(t.cartTotal),1)]),e("tr",null,[t.$route.fullPath!="/placeorder"?(l(),n("td",j,[y(x,{to:"/placeorder"},{default:V(()=>[z]),_:1})])):g("",!0)])])])}const W=P(S,[["render",G]]);export{W as C,m as f};
