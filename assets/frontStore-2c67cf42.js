import{u as h,x as o}from"./index-63941f38.js";import{S as g}from"./sweetalert2.all-2a6e8b79.js";const{VITE_API:a,VITE_PATH:i}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"sophiee22",BASE_URL:"/vue-live-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},d=h("frontStore",{state:()=>({categories:["全部商品","配件配飾","居家配件","床上用品","科技配件","衣物大全","有狗亂入"],currentCategory:"",products:[],tempProduct:{},carts:[],filteredProducts:[],isLoading:!1,fullPage:!0,loginStatus:!1}),getters:{cartTotal:({carts:t})=>t.reduce((s,e)=>s+e.final_total,0),cartlength:({carts:t})=>t.length,getNewProducts:({products:t})=>t.slice(-3),getFilterCategoryProducts:({filteredProducts:t})=>t==null?void 0:t.slice(-3)},actions:{login(t){JSON.parse(localStorage.getItem(t.登入名稱))===t.登入密碼?(this.loginStatus=!0,this.toastMessge("歡迎回來！"),this.router.go(-1)):(this.alertMessage("登入不成功"),this.loginStatus=!1)},logout(){this.loginStatus=!1,this.router.replace("/")},register(t){JSON.parse(localStorage.getItem(t.註冊名稱))?(this.alertMessage("此會員已登記，請登入"),this.router.replace("/login")):(localStorage.setItem(t.註冊名稱,JSON.stringify(t.註冊密碼)),this.toastMessge("恭喜！你已成功登記！"),this.loginStatus=!0,this.router.replace("/"))},async getProducts(t=""){this.isLoading=!0;const s=`${a}api/${i}/products/all`;await o.get(s).then(e=>{this.isLoading=!1;const{products:r}=e.data;if(this.products=r,t){this.currentCategory=t;const l=r.filter(c=>c.category===t);this.filteredProducts=l}else this.currentCategory="全部商品";return!0}).catch(()=>(this.isLoading=!1,this.alertMessage("取得產品列表發生錯誤"),!1))},getSingleProduct(t){this.isLoading=!0,o.get(`${a}api/${i}/product/${t}`).then(s=>{this.isLoading=!1,this.tempProduct=s.data.product}).catch(()=>{this.isLoading=!1,this.alertMessage("取得商品資訊發生錯誤!"),this.router.push("/products")})},getCarts(){o.get(`${a}api/${i}/cart`).then(t=>{this.isLoading=!1,this.carts=t.data.data.carts}).catch(()=>{this.isLoading=!1,this.alertMessage("無法取得購物車列表!")})},addCart(t,s=1){if(this.loginStatus){let e=s,r="post",l=`${a}api/${i}/cart`;t.qty&&(r="put",l=`${a}api/${i}/cart/${t.id}`,e+=t.qty);const c={product_id:t.id,qty:e};o[r](l,{data:c}).then(()=>{this.toastMessge("已加入購物車！"),this.getCarts()}).catch(()=>{this.alertMessage("加入購物車發生錯誤")})}else this.alertMessage("請先登入"),this.router.push("/login")},emptyCart(){o.delete(`${a}api/${i}/carts`).then(()=>{this.toastMessge("已加入購物車！"),this.getCarts()}).catch(()=>{this.this.alertMessage("無法清空購物車")})},async filterProductList(t=""){await this.getProducts();const s=this.products.filter(e=>e.category===t);this.filteredProducts=s},alertMessage(t){g.fire({text:t,timer:1e3})},toastMessge(t){g.fire({toast:!0,position:"top-end",icon:"success",title:t,showConfirmButton:!1,timer:1e3})}}});export{d as f};
