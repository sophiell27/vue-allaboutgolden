import{u as h,x as l,M as u,y as i}from"./index-f8c59545.js";import{S as c}from"./sweetalert2.all-7698f33b.js";const{VITE_API:r,VITE_PATH:a}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"sophiee22",BASE_URL:"/vue-live-final/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},f=h("frontStore",{state:()=>({products:[],tempProduct:{},carts:[],filterProducts:[]}),getters:{cartTotal:({carts:t})=>t.reduce((e,s)=>e+s.final_total,0),cartlength:({carts:t})=>t.length},actions:{playLoading(){const e=l.useLoading().show({loader:u});setTimeout(()=>{e.hide()},1e3)},async getProducts(){return this.playLoading(),await(async()=>{try{const e=await i.get(`${r}api/${a}/products/all`);return this.products=e.data.products,!0}catch{return alert("取得產品列表發生錯誤"),!1}})()},getSingleProduct(t){i.get(`${r}api/${a}/product/${t}`).then(e=>{this.tempProduct=e.data.product}).catch(e=>{this.alertMessage("取得商品資訊發生錯誤!"),this.router.push("/products")})},getCarts(){i.get(`${r}api/${a}/cart`).then(t=>{this.carts=t.data.data.carts}).catch(()=>{this.alertMessage("無法取得購物車列表!")})},addCart(t,e=1){let s="post",o=`${r}api/${a}/cart`;t.qty&&(s="put",o=`${r}api/${a}/cart/${t.id}`,e+=t.qty);const n={product_id:t.id,qty:e};i[s](o,{data:n}).then(d=>{this.toastMessge("已加入購物車！"),this.getCarts()}).catch(d=>{this.alertMessage("加入購物車發生錯誤")})},emptyCart(){i.delete(`${r}api/${a}/carts`).then(t=>{this.toastMessge("已加入購物車！"),this.getCarts()}).catch(t=>{this.this.alertMessage("無法清空購物車")})},async filterProductList(t=""){var s;(s=this.products)!=null&&s.length||await this.getProducts();const e=this.products.filter(o=>{if(o.category==t)return o});return this.filterProducts=e,e},alertMessage(t){c.fire({text:t,timer:1e3})},toastMessge(t){c.fire({toast:!0,position:"top-end",icon:"success",title:t,showConfirmButton:!1,timer:1e3,height:400})}}});export{f};
